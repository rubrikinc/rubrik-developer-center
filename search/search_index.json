{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Getting Started","text":""},{"location":"#why-apis-are-important","title":"Why APIs are Important","text":"<p>Automation, Integration, and Observability are all key requirements for any modern IT system. Rubrik was founded on the principle of delivering an API-first architecture, to be a perfect fit for your organization's data security and resiliency strategy.</p>"},{"location":"#rubriks-apis","title":"Rubrik's APIs","text":"<p>Rubrik has two APIs for consumption.</p>"},{"location":"#rubrik-security-cloudrsc-api","title":"Rubrik Security Cloud(RSC) API","text":"<p>The Rubrik Security Cloud API is based on GraphQL. The reason we chose GraphQL was two-fold. </p> <ol> <li>Introspection - API documentation is built in to the API itself. This means you can \"ask\" the API about itself, and there is no separate process for building documentation. The schema is the documentation. Along with built-in documentation, GraphQL is strongly-typed, which means you don't have to guess the format of the arguments to an API call. Understanding object structure is a common issue with REST.</li> <li>Performance - Rubrik has a LOT of metadata available to you. Generally you'll find that REST APIs give you every property back from an object, whether you needed it or not. This can cause performance issues and much higher complexity at scale. GraphQL allows you to select just the properties you need. This makes a big difference when we're talking about retrieving information about thousands of protected objects.</li> </ol>"},{"location":"#rubrik-cluster-api","title":"Rubrik Cluster API","text":"<p>The Rubrik Cluster API is REST based, and is located on each physical or virtual (Cloud Cluster). The primary purposes for this API are:</p> <ol> <li>Offline Recovery - In the event that you've gone dark and are unable to access the Internet, You're still able to automate your disaster recovery plan.</li> <li>Air-gapped Automation - Some systems performing backup automation may not have access to the Internet. A common example is a database server that initiates backups at a very specific time. The database server cloud have a script to freeze and write its logs, and needs to tell Rubrik to initiate the backup.</li> </ol>"},{"location":"#help-im-new-to-graphql","title":"Help! I'm new to GraphQL!","text":"<p>It can be uncomfortable learning a new technology, but GraphQL is has reached maturity and there are a number of large organizations adopting it. </p> <p>When learning any new language, I work first to understand what it actually does differently. Since it is a \"query language,\" I like to compare it to SQL. In SQL, we might say, \"Select name and ID from the VM table.\" GraphQL is similar in this idea. We run a named query which is much like a SQL table. We then select the properties called fields, which are like columns in that table. Now, I won't get too complex at this point, but some of those properties are objects that may have their own properties.</p> <p>Here's an example. Click on the arrow annotation (1) in the code to see an explanation of that part of the code.</p> <ol> <li>This is an annotation!</li> </ol> <p>Retrieve all MSSQL databases, and give me the name, ID, and the name and ID of the Rubrik Cluster that protect's this MSSQL database.</p> <pre><code>query mssqlDatabasesExample { #(1)!\n{ .annotate }\n  mssqlDatabases { # (2)!\n    nodes  { #(3)!\n      name #(4)! \n      id\n      cluster { #(5)!\n        name #(6)!\n        id\n      }\n    }\n  }\n}\n</code></pre> <ol> <li><code>mssqlDatabasesExample</code> is an operation name, You can change this to whatever you want.</li> <li><code>mssqlDatabases</code> is the name of the query in the API.</li> <li><code>nodes</code> is a paginated array of objects, in this case, mssqlDatabases.</li> <li><code>name</code> is a property, known as a <code>field</code> in GraphQL. It has a specific type, in this case <code>name</code> is a <code>String</code>.</li> <li><code>cluster</code> is also a field in the API, but unlike <code>name</code> that is of type <code>String</code>, <code>cluster</code> is a <code>Cluster</code> type, and it has its own fields.</li> <li>This is the cluster <code>name</code> field. It's a </li> </ol> <p>graphql language docs</p> <p>Talk about RSC instance and the API endpoint.</p>"},{"location":"glossary/","title":"Glossary","text":"<ul> <li>Snappable: A workload that can be protected by a Rubrik snapshot</li> <li>Connection: A paginated list of objects</li> <li>Field: Data that can be requested. A field is anything from a query to a specific property in GraphQL</li> <li>Nodes: a flat list of objects in a GraphQL connection.</li> <li>Edges: a list of objects that contain both the node and the pagination cursor.</li> </ul>"},{"location":"data-protection/data-center/vmware-vsphere/general-information/","title":"General information","text":"<p>For information on protection capabilities, see the Rubrik Security Cloud documentation</p>"},{"location":"data-protection/data-center/vmware-vsphere/job-status/","title":"Job status","text":""},{"location":"data-protection/data-center/vmware-vsphere/job-status/#description","title":"Description","text":"<p>Monitoring job status may be necessary to continue on after a job is complete.</p> <p>To monitor job status for VMware vSphere, you will need the ID of the cluster where the job is running, and the ID of the request. You can query the task status periodically until a terminal state (<code>SUCCEEDED</code>, <code>FAILED</code>, <code>CANCELLED</code>) is set given in the status field.</p>"},{"location":"data-protection/data-center/vmware-vsphere/job-status/#code-samples","title":"Code Samples","text":""},{"location":"data-protection/data-center/vmware-vsphere/job-status/#graphql","title":"GraphQL","text":"<p><pre><code>query requestStatus($id: String! $clusterUuid: UUID!) {\n  vSphereVMAsyncRequestStatus(id: $id, clusterUuid: $clusterUuid) {\n    id\n    status\n    startTime\n    progress\n    endTime\n    error {\n      message\n    }\n  }\n}\n</code></pre> For complete query capabilities, see the API Reference</p>"},{"location":"data-protection/data-center/vmware-vsphere/job-status/#rubrik-security-cloud-powershell-sdk","title":"Rubrik Security Cloud PowerShell SDK","text":"<pre><code>$statusQuery = New-RscQuery -GqlQuery vSphereVMAsyncRequestStatus\n$statusQuery.var.id = $request.Id\n$statusQuery.var.clusterUuid = $my_vm.cluster.Id\n$status = Invoke-Rsc $statusQuery\n</code></pre>"},{"location":"data-protection/data-center/vmware-vsphere/job-status/#curl","title":"curl","text":"<pre><code>curl --location 'https://EXAMPLE.my.rubrik.com/api/graphql' \\\n--header 'Content-Type: application/json' \\\n--header 'Authorization: Bearer XXXXXXX' \\\n--data '{\"query\":\"query requestStatus($id: String! $clusterUuid: UUID!) {  vSphereVMAsyncRequestStatus(id: $id clusterUuid: $clusterUuid) { id status startTime progress endTime error { message }}}\",\"variables\":{\"id\":\"TASK_ID\",\"clusterUuid\":\"CLUSTER_UUID\"}}'\n</code></pre>"},{"location":"data-protection/data-center/vmware-vsphere/on-demand-backup/","title":"On demand backup","text":""},{"location":"data-protection/data-center/vmware-vsphere/on-demand-backup/#on-demand-backup","title":"On-Demand Backup","text":""},{"location":"data-protection/data-center/vmware-vsphere/virtual-machines/","title":"Virtual machines","text":""},{"location":"data-protection/data-center/vmware-vsphere/virtual-machines/#virtual-machines","title":"Virtual Machines","text":""},{"location":"data-protection/data-center/vmware-vsphere/virtual-machines/#retrieving-virtual-machine-information","title":"Retrieving Virtual Machine Information","text":"<p>To list virtual machines known by Rubrik, you can perform the following. There are various filters to search by name, MOID, cluster, organization, and more.</p> <p>GraphQL API REFERENCE <pre><code>query getVirtualMachines {\n  vSphereVmNewConnection{\n    nodes {\n      name\n      id\n    }\n  }\n}\n</code></pre></p> <p>Rubrik Security Cloud PowerShell SDK</p> <pre><code>Get-RscVmwareVm\n</code></pre> <p>cUrl <pre><code>curl --location 'https://rubrik-gaia.my.rubrik.com/api/graphql' \\\n--header 'Content-Type: application/json' \\\n--header 'Authorization: Bearer XXXXXXX' \\\n--data '{\"query\":\"query getVirtualMachines { vSphereVmNewConnection{nodes { name id }}}\",\"variables\":{}}'\n</code></pre></p>"}]}